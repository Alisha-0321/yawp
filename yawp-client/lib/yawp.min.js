!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("yawp",[],e):"object"==typeof exports?exports.yawp=e():t.yawp=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),i=n(o),u=r(5),s=n(u);i["default"].fixtures=s["default"],e["default"]=i["default"],t.exports=e["default"]},function(t,e,r){"use strict";function n(t){var e={baseUrl:function(t){p=t},defaultFetchOptions:function(t){y=t}};t(e)}function o(t,e){var r=p+e.url,n=e.query,o=e.data;return delete e.url,delete e.query,e.method=t,e.body=o,(0,h.extend)(e,y),(0,h.baseAjax)(r,n,e)}function i(t){if(t.id)return t.id;throw"use yawp(id) if your endpoint does not have a @Id field called id"}function u(t){function e(t){return 1===arguments.length?l.where=t:l.where=[].slice.call(arguments),this}function r(t){return l.order=t,this}function n(t){return l.sort=t,this}function i(t){return l.limit=t,this}function u(e){return o("GET",t()).done(e)}function s(){Object.keys(l).length>0&&t.addQueryParameter("q",JSON.stringify(l))}function a(e){s();var r=p+t().url+(t().query?"?"+toUrlParam(t().query):"");return e?decodeURIComponent(r):r}function f(e){return s(),o("GET",t()).done(e)}function c(t){return i(1),f(function(e){var r=0===e.length?null:e[0];t&&t(r)})}function d(t){return f(function(e){if(1!==e.length)throw"called only but got "+e.length+" results";t&&t(e[0])})}var l={};return{where:e,order:r,sort:n,limit:i,fetch:u,list:f,first:c,only:d,url:a}}function s(t){function e(e){return t().data=JSON.stringify(e),o("POST",t())}function r(e){return t().data=JSON.stringify(e),o("PUT",t())}function n(e){return t().data=JSON.stringify(e),o("PATCH",t())}function i(){return o("DELETE",t())}return{create:e,update:r,patch:n,destroy:i}}function a(t){function e(e){return t().url+="/"+e,t()}function r(e){return t.setJson(e),this}function n(e){return t.addQueryParameters(e),this}function i(t){return o("GET",e(t))}function u(t){return o("PUT",e(t))}function s(t){return o("PATCH",e(t))}function a(t){return o("POST",e(t))}function f(t){return o("DELETE",e(t))}return{json:r,params:n,get:i,put:u,_patch:s,post:a,_delete:f}}function f(t){function e(t){return t?t instanceof Object?i(t):t:""}function r(){return c}function n(t){var n=e(t);return r().url=n+r().url,this}function o(t){return r.addQueryParameter("t",t),this}function f(){return c.async=!1,this}var c={url:e(t),async:!0};return r.setJson=function(t){c.data=JSON.stringify(t)},r.addQueryParameters=function(t){c.query=(0,h.extend)(c.query,t)},r.addQueryParameter=function(t,e){c.query||(c.query={}),c.query[t]=e},(0,h.extend)({from:n,transform:o,sync:f},u(r),s(r),a(r))}function c(t){var e=i(t);return f(e).update(t)}function d(t){var e=i(t);return f(e).patch(t)}function l(t){var e=i(t);return f(e).destroy(t)}Object.defineProperty(e,"__esModule",{value:!0});var h=r(2),p="/api",y={},m={config:n,update:c,patch:d,destroy:l};e["default"]=(0,h.extend)(f,m),t.exports=e["default"]},function(t,e,r){"use strict";function n(){for(var t=arguments[0]||{},e=1,r=arguments.length;e<r;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}function o(t,e,r){var o,u,s,a,f,c={fail:function(t){return o=t,c},done:function(t){return u=t,c},exception:function(t){return s=t,c},then:function(t){return a=t,c},error:function(t){return f=t,c}};return t+=e?"?"+i(r.query):"",r.headers=r.headers||{},n(r.headers,{Accept:"application/json","Content-Type":"application/json"}),console.log("url",t),console.log("options",r),fetch(t,r).then(function(t){return t.json()}).then(function(t){u&&u(t),a&&a(t)})["catch"](function(t){o&&o(t),f&&f(t),s&&s(t)}),c}function i(t){return Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}Object.defineProperty(e,"__esModule",{value:!0}),e.extend=n,e.baseAjax=o,"undefined"!=typeof self&&r(3)},function(t,e,r){r(4),t.exports=self.fetch.bind(self)},function(t,e){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=String(t)),t}function n(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return y.iterable&&(e[Symbol.iterator]=function(){return e}),e}function o(t){this.map={},t instanceof o?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function i(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function u(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function s(t){var e=new FileReader;return e.readAsArrayBuffer(t),u(e)}function a(t){var e=new FileReader;return e.readAsText(t),u(e)}function f(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(y.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(y.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(t){if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob?(this.blob=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(s)},this.text=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return a(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=i(this);return t?t:Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(t){var e=t.toUpperCase();return m.indexOf(e)>-1?e:t}function d(t,e){e=e||{};var r=e.body;if(d.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new o(t.headers)),this.method=t.method,this.mode=t.mode,r||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new o(e.headers)),this.method=c(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function l(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(o))}}),e}function h(t){var e=new o,r=(t.getAllResponseHeaders()||"").trim().split("\n");return r.forEach(function(t){var r=t.trim().split(":"),n=r.shift().trim(),o=r.join(":").trim();e.append(n,o)}),e}function p(t,e){e||(e={}),this.type="default",this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof o?e.headers:new o(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var y={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};o.prototype.append=function(t,n){t=e(t),n=r(n);var o=this.map[t];o||(o=[],this.map[t]=o),o.push(n)},o.prototype["delete"]=function(t){delete this.map[e(t)]},o.prototype.get=function(t){var r=this.map[e(t)];return r?r[0]:null},o.prototype.getAll=function(t){return this.map[e(t)]||[]},o.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},o.prototype.set=function(t,n){this.map[e(t)]=[r(n)]},o.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(r){this.map[r].forEach(function(n){t.call(e,n,r,this)},this)},this)},o.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),n(t)},o.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),n(t)},o.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),n(t)},y.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this)},f.call(d.prototype),f.call(p.prototype),p.prototype.clone=function(){return new p(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},p.error=function(){var t=new p(null,{status:0,statusText:""});return t.type="error",t};var b=[301,302,303,307,308];p.redirect=function(t,e){if(b.indexOf(e)===-1)throw new RangeError("Invalid status code");return new p(null,{status:e,headers:{location:t}})},t.Headers=o,t.Request=d,t.Response=p,t.fetch=function(t,e){return new Promise(function(r,n){function o(){return"responseURL"in u?u.responseURL:/^X-Request-URL:/m.test(u.getAllResponseHeaders())?u.getResponseHeader("X-Request-URL"):void 0}var i;i=d.prototype.isPrototypeOf(t)&&!e?t:new d(t,e);var u=new XMLHttpRequest;u.onload=function(){var t={status:u.status,statusText:u.statusText,headers:h(u),url:o()},e="response"in u?u.response:u.responseText;r(new p(e,t))},u.onerror=function(){n(new TypeError("Network request failed"))},u.ontimeout=function(){n(new TypeError("Network request failed"))},u.open(i.method,i.url,!0),"include"===i.credentials&&(u.withCredentials=!0),"responseType"in u&&y.blob&&(u.responseType="blob"),i.headers.forEach(function(t,e){u.setRequestHeader(e,t)}),u.send("undefined"==typeof i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(t,e,r){"use strict";function n(t){var e={baseUrl:function(t){b=t},resetUrl:function(t){v=t},lazyPropertyKeys:function(t){w=t},bind:function(t,e,r){x[t]=o(d,e,r)}};t(e),x.lazy=y()}function o(t,e,r){var n=function(){var n=Array.prototype.slice.call(arguments,0);return n.unshift(r),n.unshift(e),t.apply(this,n)};return n.endpoint=e,n}function i(){(0,m.baseAjax)(v,null,{method:"GET",async:!1}),E={}}function u(t){var e;for(e in t)if(t.hasOwnProperty(e)){var r=t[e];r instanceof Function?t[e]=r():r instanceof Object&&u(r)}}function s(t){var e={};return(0,m.extend)(e,t),u(e),JSON.stringify(e)}function a(t,e,r){var n=null;t||console.error("not endpoint?!");var o=b+(e?r[e]:"")+t,i=null;return(0,m.baseAjax)(o,i,{method:"POST",async:!1,body:s(r)}).done(function(t){n=t}).fail(function(t){throw Error("error: "+t)}),console.log("r",n),n}function f(t,e){return E[t]?E[t][e]:(E[t]={},null)}function c(t,e){return!!T[t]&&!!T[t][e]}function d(t,e,r,n){var o=f(t,r);if(o)return o;if(!n){if(!c(t,r))return null;n=T[t][r]}return o=a(t,e,n),E[t][r]=o,o}function l(t){var e={};for(var r in t){var n=t[r],o=n.key,i=n.value;o instanceof Function&&(o=o()),e[o]=i}return e}function h(t,e){function r(r){return function(){return x[t](e)[r]}}var n,o={};for(n=0;n<w.length;n++){var i=w[n];o[i]=r(i)}return o}function p(t){return function(){return l(t)}}function y(){function t(t,e){return function(r,n){if(T[e]){if(T[e][r])return P[e][r]}else T[e]={},P[e]={};T[e][r]=n,P[e][r]=h(t,r)}}var e={};for(var r in x){var n=x[r].endpoint;e[r]=t(r,n)}return e.map=p,e}Object.defineProperty(e,"__esModule",{value:!0});var m=r(2),b="/fixtures",v="/_ah/yawp/datastore/delete_all",w=["id"],x={},T={},P={},E={};x.lazy=y(),x.reset=i,x.map=l,x.config=n,e["default"]=x,t.exports=e["default"]}])});
//# sourceMappingURL=yawp.min.js.map