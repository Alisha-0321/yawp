!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("yawp",[],e):"object"==typeof exports?exports.yawp=e():t.yawp=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var u=n[r]={exports:{},id:r,loaded:!1};return t[r].call(u.exports,u,u.exports,e),u.loaded=!0,u.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var u=n(1),o=r(u),i=n(3)(o.default);e.default=i,t.exports=e.default},function(t,e,n){"use strict";function r(t,e,n,r){4===t.readyState&&(200===t.status?n(e.json?JSON.parse(t.responseText):t.responseText):r(t))}function u(t,e){e&&"omit"!==e&&(t.withCredentials=!0)}function o(t,e){e=e||{},(0,i.extend)(e,{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"});for(var n in e)e.hasOwnProperty(n)&&t.setRequestHeader(n,e[n])}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return new Promise(function(n,a){var c=e.query;delete e.query;var s=new XMLHttpRequest;s.onreadystatechange=function(){r(s,e,n,a)},s.open(e.method,t+(c?"?"+(0,i.toUrlParam)(c):"")),o(s,e.headers),u(s,e.credentials),s.send(e.body)})};var i=n(2);t.exports=e.default},function(t,e){"use strict";function n(){for(var t=arguments[0]||{},e=1,n=arguments.length;e<n;e++){var r=arguments[e];for(var u in r)t[u]=r[u]}return t}function r(t){return Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}Object.defineProperty(e,"__esModule",{value:!0}),e.extend=n,e.toUrlParam=r},function(t,e,n){"use strict";function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t){return t?t instanceof Object?c(t):t:""}function a(t){return t.id}function c(t){if(a(t))return t.id;throw"use yawp(id) if your endpoint does not have a @Id field called id"}Object.defineProperty(e,"__esModule",{value:!0});var s=function t(e,n,r){null===e&&(e=Function.prototype);var u=Object.getOwnPropertyDescriptor(e,n);if(void 0===u){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in u)return u.value;var i=u.get;if(void 0!==i)return i.call(r)},f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(2),p="/api",y={},h=null,d=void 0,v=void 0;e.default=function(t){function e(n){var b={},k={},O=function(){function O(t){o(this,O),t&&(0,l.extend)(this,t)}return f(O,[{key:"save",value:function(t){var e=this.createOrUpdate();return t?e.then(t):e}},{key:"createOrUpdate",value:function(){var t=this,e=void 0;return a(this)?(b.url=this.id,e=this.constructor.update(this)):e=this.constructor.create(this).then(function(e){return t.id=e.id,e}),e}},{key:"destroy",value:function(t){var e=this.constructor.destroy(this);return t?e.then(t):e}},{key:"get",value:function(t){return b.url=c(this),this.constructor.get(t)}},{key:"put",value:function(t){return b.url=c(this),this.constructor.put(t)}},{key:"_patch",value:function(t){return b.url=c(this),this.constructor._patch(t)}},{key:"post",value:function(t){return b.url=c(this),this.constructor.post(t)}},{key:"_delete",value:function(t){return b.url=c(this),this.constructor._delete(t)}}],[{key:"clear",value:function(){b={url:i(n)},k={}}},{key:"prepareRequestOptions",value:function(){var t=(0,l.extend)({},b);return this.clear(),t}},{key:"baseRequest",value:function(e){var n=this.prepareRequestOptions(),r=p+n.url;delete n.url,n.method=e,n.json=!0,(0,l.extend)(n,y),h&&h(n);var u=t(r,n);return d&&(u=u.then(d)),v&&(u=u.catch(v)),u}},{key:"wrapInstance",value:function(t){return new this(t)}},{key:"wrapArray",value:function(t){var e=this;return t.map(function(t){return e.wrapInstance(t)})}},{key:"wrappedRequest",value:function(t){var e=this;return this.baseRequest(t).then(function(t){return Array===t.constructor?e.wrapArray(t):e.wrapInstance(t)})}},{key:"from",value:function(t){var e=i(t);return b.url=e+b.url,this}},{key:"transform",value:function(t){return this.param("t",t),this}},{key:"where",value:function(t){return 1===arguments.length?k.where=t:k.where=[].slice.call(arguments),this}},{key:"order",value:function(t){return k.order=t,this}},{key:"sort",value:function(t){return k.sort=t,this}},{key:"limit",value:function(t){return k.limit=t,this}},{key:"fetch",value:function(t){var e="function"==typeof t?t:void 0;t&&!e&&(b.url+="/"+t);var n=this.wrappedRequest("GET");return e?n.then(e):n}},{key:"setupQuery",value:function(){Object.keys(k).length>0&&this.param("q",JSON.stringify(k))}},{key:"list",value:function(t){this.setupQuery();var e=this.wrappedRequest("GET");return t?e.then(t):e}},{key:"first",value:function(t){return this.limit(1),this.list(function(e){var n=0===e.length?null:e[0];return t?t(n):n})}},{key:"only",value:function(t){return this.list(function(e){if(1!==e.length)throw"called only but got "+e.length+" results";var n=e[0];return t?t(n):n})}},{key:"create",value:function(t){return b.body=JSON.stringify(t),this.wrappedRequest("POST")}},{key:"update",value:function(t){return b.url=t.id,b.body=JSON.stringify(t),this.wrappedRequest("PUT")}},{key:"patch",value:function(t){return b.url=t.id,b.body=JSON.stringify(t),this.wrappedRequest("PATCH")}},{key:"destroy",value:function(t){return t&&(b.url=c(t)),this.baseRequest("DELETE")}},{key:"json",value:function(t){return b.body=JSON.stringify(t),this}},{key:"params",value:function(t){return b.query=(0,l.extend)(b.query,t),this}},{key:"param",value:function(t,e){b.query||(b.query={}),b.query[t]=e}},{key:"action",value:function(t,e){return b.url+="/"+e,this.baseRequest(t)}},{key:"get",value:function(t){return this.action("GET",t)}},{key:"put",value:function(t){return this.action("PUT",t)}},{key:"_patch",value:function(t){return this.action("PATCH",t)}},{key:"post",value:function(t){return this.action("POST",t)}},{key:"_delete",value:function(t){return this.action("DELETE",t)}},{key:"subclass",value:function(t){var i=e(n),a=this,c=function(e){function n(){o(this,n);var e=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return a.bindBaseMethods(e,i),t?t.apply(e,arguments):s(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"constructor",e).apply(e,arguments),e}return u(n,e),n}(i);return c.super=i,c}},{key:"bindBaseMethods",value:function(t,e){t.super=function(){};for(var n=Object.getOwnPropertyNames(e.prototype),r=0,u=n.length;r<u;r++){var o=n[r];t.super[o]=e.prototype[o].bind(t)}}}]),O}();return O.clear(),O}function n(t){h=t}function b(t){var e={baseUrl:function(t){p=t},defaultFetchOptions:function(t){y=t},then:function(t){d=t},catch:function(t){v=t}};t(e)}function k(t){var n=c(t);return e(n).update(t)}function O(t){var n=c(t);return e(n).patch(t)}function w(t){var n=c(t);return e(n).destroy(t)}var m={config:b,customFetchOptions:n,update:k,patch:O,destroy:w};return(0,l.extend)(e,m)},t.exports=e.default}])});
//# sourceMappingURL=yawp.min.js.map