{"version":3,"sources":["../../../src/node/request.js"],"names":["request","fetch","eval","url","options","query","json","jsonRequest","headers","then","response"],"mappings":";;;;;kBAMwBA,O;;AANxB;;AAEA,IAAI,OAAOC,KAAP,KAAiB,WAArB,EAAkC;AAC9B,QAAIA,QAAQC,KAAK,uBAAL,CAAZ;AACH;;AAEc,SAASF,OAAT,CAAiBG,GAAjB,EAAsBC,OAAtB,EAA+B;AAC1C,QAAIC,QAAQD,QAAQC,KAApB;AACA,WAAOD,QAAQC,KAAf;;AAEAF,WAAQE,QAAQ,MAAM,uBAAWA,KAAX,CAAd,GAAkC,EAA1C;;AAEA;;AAEA,QAAI,CAACD,QAAQE,IAAb,EAAmB;AACf,eAAOL,MAAME,GAAN,EAAWC,OAAX,CAAP;AACH;AACD,WAAOG,YAAYH,OAAZ,EAAqBD,GAArB,CAAP;AACH;;AAED,SAASI,WAAT,CAAqBH,OAArB,EAA8BD,GAA9B,EAAmC;AAC/BC,YAAQI,OAAR,GAAkBJ,QAAQI,OAAR,IAAmB,EAArC;AACA,uBAAOJ,QAAQI,OAAf,EAAwB;AACpB,kBAAU,kBADU;AAEpB,wBAAgB;AAFI,KAAxB;AAIA,WAAOP,MAAME,GAAN,EAAWC,OAAX,EAAoBK,IAApB,CAAyB,UAACC,QAAD;AAAA,eAAcA,SAASJ,IAAT,EAAd;AAAA,KAAzB,CAAP;AACH","file":"request.js","sourcesContent":["import { extend, toUrlParam } from '../commons/utils';\n\nif (typeof fetch === 'undefined') {\n    var fetch = eval(\"require('node-fetch')\");\n}\n\nexport default function request(url, options) {\n    var query = options.query;\n    delete options.query;\n\n    url += (query ? '?' + toUrlParam(query) : '');\n\n    // console.log('request', url, options);\n\n    if (!options.json) {\n        return fetch(url, options);\n    }\n    return jsonRequest(options, url);\n}\n\nfunction jsonRequest(options, url) {\n    options.headers = options.headers || {};\n    extend(options.headers, {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json;charset=UTF-8',\n    });\n    return fetch(url, options).then((response) => response.json());\n}\n"]}