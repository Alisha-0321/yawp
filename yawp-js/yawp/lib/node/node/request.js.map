{"version":3,"sources":["../../../src/node/request.js"],"names":["request","nodeFetch","fetch","eval","url","options","query","json","jsonRequest","headers","then","response"],"mappings":";;;;;kBAUwBA,O;;AAVxB;;AAEA,IAAIC,SAAJ;;AAEA,IAAI,OAAOC,KAAP,KAAiB,WAArB,EAAkC;AAC9BD,gBAAYE,KAAK,uBAAL,CAAZ;AACH,CAFD,MAEO;AACHF,gBAAYC,KAAZ;AACH;;AAEc,SAASF,OAAT,CAAiBI,GAAjB,EAAsBC,OAAtB,EAA+B;AAC1C,QAAIC,QAAQD,QAAQC,KAApB;AACA,WAAOD,QAAQC,KAAf;;AAEAF,WAAQE,QAAQ,MAAM,uBAAWA,KAAX,CAAd,GAAkC,EAA1C;;AAEA;;AAEA,QAAI,CAACD,QAAQE,IAAb,EAAmB;AACf,eAAON,UAAUG,GAAV,EAAeC,OAAf,CAAP;AACH;AACD,WAAOG,YAAYH,OAAZ,EAAqBD,GAArB,CAAP;AACH;;AAED,SAASI,WAAT,CAAqBH,OAArB,EAA8BD,GAA9B,EAAmC;AAC/BC,YAAQI,OAAR,GAAkBJ,QAAQI,OAAR,IAAmB,EAArC;AACA,uBAAOJ,QAAQI,OAAf,EAAwB;AACpB,kBAAU,kBADU;AAEpB,wBAAgB;AAFI,KAAxB;AAIA,WAAOR,UAAUG,GAAV,EAAeC,OAAf,EAAwBK,IAAxB,CAA6B,UAACC,QAAD;AAAA,eAAaA,SAASJ,IAAT,EAAb;AAAA,KAA7B,CAAP;AACH","file":"request.js","sourcesContent":["import { extend, toUrlParam } from '../commons/utils';\n\nvar nodeFetch;\n\nif (typeof fetch === 'undefined') {\n    nodeFetch = eval(\"require('node-fetch')\");\n} else {\n    nodeFetch = fetch;\n}\n\nexport default function request(url, options) {\n    var query = options.query;\n    delete options.query;\n\n    url += (query ? '?' + toUrlParam(query) : '');\n\n    //console.log('request', url, options);\n\n    if (!options.json) {\n        return nodeFetch(url, options);\n    }\n    return jsonRequest(options, url);\n}\n\nfunction jsonRequest(options, url) {\n    options.headers = options.headers || {};\n    extend(options.headers, {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json;charset=UTF-8',\n    });\n    return nodeFetch(url, options).then((response) =>response.json());\n}\n"]}