{"version":3,"sources":["../../../src/commons/yawp.js"],"names":["baseUrl","defaultFetchOptions","normalize","arg","Object","extractId","hasId","object","id","request","yawpFn","baseArg","options","q","Yawp","props","cb","promise","createOrUpdate","then","url","update","create","destroy","action","get","put","_patch","post","_delete","_options","clear","type","prepareRequestOptions","method","json","objects","map","wrapInstance","parentBaseArg","parentBase","t","param","data","arguments","length","where","slice","call","order","sort","limit","undefined","baseRequest","keys","JSON","stringify","setupQuery","wrapArray","list","body","params","query","key","value","verb","path","constructorFn","base","sub","bindBaseMethods","apply","super","self","getOwnPropertyNames","prototype","i","l","bind","config","c","patch","baseApi"],"mappings":"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","file":"yawp.js","sourcesContent":["import { extend } from './utils';\n\nlet baseUrl = '/api';\nlet defaultFetchOptions = {};\n\nfunction normalize(arg) {\n    if (!arg) {\n        return '';\n    }\n    if (arg instanceof Object) {\n        return extractId(arg);\n    }\n    return arg;\n}\n\nfunction hasId(object) {\n    return object.id;\n}\n\nfunction extractId(object) {\n    if (hasId(object)) {\n        return object.id;\n    }\n    throw 'use yawp(id) if your endpoint does not have a @Id field called id';\n}\n\nexport default (request) => {\n\n    function yawpFn(baseArg) {\n\n        let options = {};\n        let q = {};\n\n        class Yawp {\n\n            constructor(props) {\n                if (props) {\n                    extend(this, props);\n                }\n            }\n\n            // request\n\n            static clear() {\n                options = {\n                    url: normalize(baseArg)\n                };\n            }\n\n            static prepareRequestOptions() {\n                let _options = extend({}, options);\n                Yawp.clear();\n                return _options;\n            }\n\n            static baseRequest(type) {\n                let options = Yawp.prepareRequestOptions();\n\n                let url = baseUrl + options.url;\n                delete options.url;\n\n                options.method = type;\n                options.json = true;\n                extend(options, defaultFetchOptions);\n\n                //console.log('request', url, options);\n\n                return request(url, options);\n            }\n\n            static wrapInstance(object) {\n                return new this(object);\n            }\n\n            static wrapArray(objects) {\n                return objects.map((object) => this.wrapInstance(object));\n            }\n\n            // query\n\n            static from(parentBaseArg) {\n                let parentBase = normalize(parentBaseArg);\n                options.url = parentBase + options.url;\n                return this;\n            }\n\n            static transform(t) {\n                Yawp.param('t', t);\n                return this;\n            }\n\n            static where(data) {\n                if (arguments.length === 1) {\n                    q.where = data;\n                } else {\n                    q.where = [].slice.call(arguments);\n                }\n                return this;\n            }\n\n            static order(data) {\n                q.order = data;\n                return this;\n            }\n\n            static sort(data) {\n                q.sort = data;\n                return this;\n            }\n\n            static limit(data) {\n                q.limit = data;\n                return this;\n            }\n\n            static fetch(arg) {\n                let cb = typeof arg === 'function' ? arg : undefined;\n\n                if (arg && !cb) {\n                    options.url += '/' + arg;\n                }\n\n                let promise = Yawp.baseRequest('GET').then((object) => {\n                    return this.wrapInstance(object);\n                });\n\n                if (cb) {\n                    return promise.then(cb);\n                }\n\n                return promise;\n            }\n\n            static setupQuery() {\n                if (Object.keys(q).length > 0) {\n                    Yawp.param('q', JSON.stringify(q));\n                }\n            }\n\n            static list(cb) {\n                Yawp.setupQuery();\n\n                let promise = Yawp.baseRequest('GET').then((objects) => {\n                    return this.wrapArray(objects);\n                });\n\n                if (cb) {\n                    return promise.then(cb);\n                }\n                return promise;\n            }\n\n            static first(cb) {\n                Yawp.limit(1);\n\n                return Yawp.list((objects) => {\n                    let object = objects.length === 0 ? null : objects[0];\n                    return cb ? cb(object) : object;\n                });\n            }\n\n            static only(cb) {\n                return Yawp.list((objects) => {\n                    if (objects.length !== 1) {\n                        throw 'called only but got ' + objects.length + ' results';\n                    }\n                    let object = objects[0];\n                    return cb ? cb(object) : object;\n                });\n            }\n\n            // repository\n\n            static create(object) {\n                options.body = JSON.stringify(object);\n                return Yawp.baseRequest('POST');\n            }\n\n            static update(object) {\n                options.body = JSON.stringify(object);\n                return Yawp.baseRequest('PUT');\n            }\n\n            static patch(object) {\n                options.body = JSON.stringify(object);\n                return Yawp.baseRequest('PATCH');\n            }\n\n            static destroy() {\n                return Yawp.baseRequest('DELETE');\n            }\n\n            // actions\n\n            static json(object) {\n                options.body = JSON.stringify(object);\n                return this;\n            }\n\n            static params(params) {\n                options.query = extend(options.query, params);\n                return this;\n            }\n\n            static param(key, value) {\n                if (!options.query) {\n                    options.query = {};\n                }\n                options.query[key] = value;\n            }\n\n            static action(verb, path) {\n                options.url += '/' + path;\n                return Yawp.baseRequest(verb);\n            }\n\n            static get(action) {\n                return Yawp.action('GET', action);\n            }\n\n            static put(action) {\n                return Yawp.action('PUT', action);\n            }\n\n            static _patch(action) {\n                return Yawp.action('PATCH', action);\n            }\n\n            static post(action) {\n                return Yawp.action('POST', action);\n            }\n\n            static _delete(action) {\n                return Yawp.action('DELETE', action);\n            }\n\n            // es5 subclassing\n\n            static subclass(constructorFn) {\n                let base = yawpFn(baseArg);\n                let sub = class extends base {\n                    constructor() {\n                        super();\n                        Yawp.bindBaseMethods(this, base);\n                        if (constructorFn) {\n                            constructorFn.apply(this, arguments);\n                        } else {\n                            super.constructor.apply(this, arguments);\n                        }\n                    }\n                };\n                sub.super = base;\n                return sub;\n            }\n\n            static bindBaseMethods(self, base) {\n                self.super = () => {\n                };\n                var keys = Object.getOwnPropertyNames(base.prototype);\n                for (let i = 0, l = keys.length; i < l; i++) {\n                    let key = keys[i];\n                    self.super[key] = base.prototype[key].bind(self);\n                }\n            }\n\n            // instance method\n\n            save(cb) {\n                let promise = this.createOrUpdate();\n                return cb ? promise.then(cb) : promise;\n            }\n\n            createOrUpdate() {\n                let promise;\n                if (hasId(this)) {\n                    options.url = this.id;\n                    promise = Yawp.update(this);\n                } else {\n                    promise = Yawp.create(this).then((object) => {\n                        this.id = object.id;\n                        return object;\n                    });\n                }\n                return promise;\n            }\n\n            destroy(cb) {\n                options.url = extractId(this);\n                let promise = Yawp.destroy();\n                return cb ? promise.then(cb) : promise;\n            }\n\n            get(action) {\n                options.url = extractId(this);\n                return Yawp.get(action);\n            }\n\n            put(action) {\n                options.url = extractId(this);\n                return Yawp.put(action);\n            }\n\n            _patch(action) {\n                options.url = extractId(this);\n                return Yawp._patch(action);\n            }\n\n            post(action) {\n                options.url = extractId(this);\n                return Yawp.post(action);\n            }\n\n            _delete(action) {\n                options.url = extractId(this);\n                return Yawp._delete(action);\n            }\n        }\n\n        Yawp.clear();\n        return Yawp;\n    }\n\n    // base api\n\n    function config(cb) {\n        let c = {\n            baseUrl: (url) => {\n                baseUrl = url;\n            },\n            defaultFetchOptions: (options) => {\n                defaultFetchOptions = options;\n            }\n        };\n        cb(c);\n    };\n\n    function update(object) {\n        let id = extractId(object);\n        return yawpFn(id).update(object);\n    }\n\n    function patch(object) {\n        let id = extractId(object);\n        return yawpFn(id).patch(object);\n    }\n\n    function destroy(object) {\n        let id = extractId(object);\n        return yawpFn(id).destroy(object);\n    }\n\n    let baseApi = {\n        config,\n        update,\n        patch,\n        destroy\n    }\n\n    return extend(yawpFn, baseApi);\n}"]}